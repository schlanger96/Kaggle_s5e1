# 할인하는 스티커 가격 예측 (Backpack Prediction Challenge)  

----------------------------------------------------

# 경연 개요  
본 경연은 스티커 가격 예측 문제를 해결하기 위한 머신러닝 모델을 만드는 것이 목표

---------------------------------------------------

# 요약  
주어진 데이터는 3개의 범주형, 1개의 시계열 변수가 있는 데이터,
EDA로 모든 변수가 타겟에 미치는 영향 확인
타겟의 분포를 기준으로 데이터를 4개로 군집화 (매우낮은 판매량, 낮은 판매량, 높은판매량, 매우높은 판매량)
군집 별 EDA와 주파수 분석으로 유의미한 변수와 주기성 확인
EDA 결과를 기반으로 파생변수 추가,
XGboost 모델 사용, 다양한 전처리 기법, 하이퍼 파라미터 튜닝 실험으로 모델 성능 비교
  
일,월,연도 별 sin,cos 파생변수를 추가한 모델이 최종 성능 최고 기록  
최종 MAPE : 0.11671  
최종 등수 = 552 / 2722 (상위 20.2%)

---------------------------------------------------

# 1. 데이터 크기  
학습 데이터: 230,130행 × 6열  
검증 데이터: 200,000행 × 9열

--------------------------------------------------

# 2. 평가지표  
MAPE (Mean Absolute Percentage Error, 평균 절대 백분율 오차)  

-------------------------------------------------

# 3. 변수 정보  
country (나라)
store (가게 종류)
product (제품 종류) 
num_sold (판매량)  

-------------------------------------------------

# 4. 시도해본 데이터 전처리

k-평균 군집분석으로 데이터 군집화 시도
임의로 구간을 나누어 군집화 시도
군집 별 EDA 분석
군집 별 스펙트럼 밀도함수를 통한 주파수 분석(주기성 확인)
타겟 로그변환으로 비선형성 완화
여러가지 주기성 변수 추가 (sin, cos)
EDA 결과 기반 가중치 파생변수 추가

-------------------------------------------------------------

# 5. 최종 캐글 제출 모델 및 성능  

XGBoost 모델 사용
Kaggle Public Score: 0.11404
결측치 데이터 제외
일,월,연도 별 sin,cos 파생변수 추가
모든 범주형 변수 EDA 결과 기반 순서 인코딩

-----------------------------------------------------------------

# 6. 학습 과정에서 얻은 인사이트  

1. 학습 데이터에서 범주형 변수의 범주 별 차이가 명확하더라도 가중치 변수는 학습에 도움이 되지 않는다
2. 시계열 데이터를 학습할 때, sin, cos 함수를 사용해 주기성 정보를 알 수 있는 파생변수를 만드는 것은 큰 도움이 된다

사용한 주요 라이브러리  
XGBoost, Scikit-Learn, Pandas, NumPy, Optuna, tqdm

-----------------------------------------------------------------

# 7. 관련 링크
Kaggle 경진대회 페이지: [https://www.kaggle.com/competitions/playground-series-s5e1/overview]  
